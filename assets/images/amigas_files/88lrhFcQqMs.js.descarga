if (self.CavalryLogger) { CavalryLogger.start_js(["\/T1K5"]); }

__d("UFIAddCommentController",["Parent","PrivateCommentsConfig","React","ReactDOM","UFIAddComment.react","UFIAddCommentActionType","UFIAsyncWrapper","UFICallbackStore","UFICommentEditIDStore","UFIDispatcher","UFIDispatcherContext.react","UFIFeedbackContext.react","UFINewCommentNotifier"],(function(a,b,c,d,e,f){"use strict";__p&&__p();g.factory=function(a,b){b.rootid=a.id;return new g(a,Object.freeze(b))};function g(a,c){this.renderAddComment=function(a,c){return this.$5!==null||!c||!c.cancomment||!c.actorforpost?null:b("React").createElement(b("UFIAddComment.react"),{viewerActorID:c.actorforpost,targetID:c.ownerid,targetName:c.actorname,groupID:c.grouporeventid,initialData:null,ref:null,withoutSeparator:!1,editingComment:{},isEditing:!1,allowLiveVideoCommentReplyMode:!0,mentionsDataSource:c.mentionsdatasource,showSendOnEnterTip:c.showsendonentertip,peopleOutsideCommunityInCommentNotice:c.peopleoutsidecommunityincommentnotice,allowPhotoAttachments:c.allowphotoattachments&&!a.islivestreaming,allowVideoAttachments:c.allowvideoattachments&&!a.islivestreaming,allowFileAttachments:c.allowfileattachments&&!a.islivestreaming,allowStickerAttachments:c.allowstickerattachments&&(!a.islivestreaming||c.allowLiveVideoStickerAttachments),allowCustomStickerAttachments:c.allowgaminglivestreamcustomstickers,allowGifAttachments:c.allowgifattachments&&(!a.islivestreaming||c.allowgaminglivestreamgifattachments),allowNativeTipJar:c.isnativetipjarenabled,tipJarModule:c.tipjarmodule,allowFlexibleTipping:c.isflexibletippingenabled,flexibleStarsModule:c.flexiblestarsmodule,allowTogglePrivateComments:(b("PrivateCommentsConfig").composer_lock_enabled||b("PrivateCommentsConfig").composer_unlocked_lock_enabled)&&c.canviewercommentinprivate,privateCommentTarget:c.actorname,contextArgs:a,feedback:c,subtitle:c.subtitle,commentsTargetID:c.commentstargetfbid,allowCommentMarkdown:a.allowcommentmarkdown})}.bind(this),this.$1=a,this.$2=c,this.$3=new(b("UFIDispatcher"))(),this.$4={UFICallbackStore:new(b("UFICallbackStore"))(this.$3)},this.$4.UFICallbackStore.on(b("UFIAddCommentActionType").SUBMIT_NEW,function(c){return b("UFINewCommentNotifier").onNewComment(b("Parent").byTag(a,"form"),this.$2,c.comment,c.target,c.replyCommentID,c.timestamp)}.bind(this)),this.$5=b("UFICommentEditIDStore").getForInstance(this.$2.instanceid),b("UFICommentEditIDStore").addListener(function(){var a=b("UFICommentEditIDStore").getForInstance(this.$2.instanceid);a!=this.$5&&(this.$5=a,this.render())}.bind(this)),this.render()}g.prototype.render=function(){var a=b("React").createElement(b("UFIDispatcherContext.react"),{dispatcher:this.$3,stores:this.$4},b("React").createElement(b("UFIFeedbackContext.react"),{contextArgs:this.$2,render:this.renderAddComment}));b("ReactDOM").render(b("React").createElement(b("UFIAsyncWrapper"),null,a),this.$1)};g.prototype.disable=function(){this.$4.UFICallbackStore.remove()};e.exports=g}),null);
__d("XFamilyBulkTagAddAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/family/bulk_tag_save/",{subject:{type:"Int"},save_tags:{type:"String"}})}),null);
__d("PhotoTagStore",["ActorURI","AsyncRequest","XFamilyBulkTagAddAsyncController","isEmpty"],(function(a,b,c,d,e,f){__p&&__p();function g(){"use strict";this._tagList={},this._textTagList={},this._originalTagList={},this._dirtyPhotosByUid={},g.instance=this}g.prototype.getPhotoTags=function(a){"use strict";return this._tagList[a]||{}};g.prototype.photoHasTags=function(a){"use strict";return!b("isEmpty")(this.getPhotoTags(a))};g.prototype.clear=function(){"use strict";this._tagList={},this._textTagList={},this._originalTagList={},this._dirtyPhotosByUid={}};g.prototype.addTag=function(a,b,c,d){"use strict";a[b]=a[b]||{};var e=a[b][c]||[];e.push(d);a[b][c]=e};g.prototype.revert=function(a){"use strict";var c=this._tagList,d=this._originalTagList;for(var e in c)b("isEmpty")(d[e][a])?c[e][a]=[]:c[e][a]=d[e][a];this._dirtyPhotosByUid={}};g.prototype.hasNewTags=function(){"use strict";return!b("isEmpty")(this._tagList)||!b("isEmpty")(this._textTagList)};g.prototype.userHasDirtyTags=function(a){"use strict";return!b("isEmpty")(this._dirtyPhotosByUid[a])};g.prototype.userDirtyTagsCount=function(a){"use strict";return Object.keys(this._dirtyPhotosByUid[a]).length};g.prototype.handleTagFetch=function(a){"use strict";for(var b in a)this.loadTagInfo(b,a[b])};g.prototype.saveAlbumTagsForUser=function(a,c,d,e){__p&&__p();e===void 0&&(e=!1);var f={},g=[],h=this._dirtyPhotosByUid[a]||{};for(var i in h){h=this._tagList[i][a];if(b("isEmpty")(h)){g[g.length]=i;continue}h.forEach(function(a){f[i]={x:a.x,y:a.y}})}h={subject:a,action:"save",save_tags:f};g=b("ActorURI").create("/ajax/photos/album/tags.php",c);e&&(h={subject:a,save_tags:JSON.stringify(f)},g=b("XFamilyBulkTagAddAsyncController").getURIBuilder().getURI());new(b("AsyncRequest"))().setURI(g).setData(h).setHandler(function(a){d(a.payload)}).setAllowCrossPageTransition(!0).send();delete this._dirtyPhotosByUid[a]};g.prototype.getTagsFromList=function(a){"use strict";var b=[];for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c))for(var d in a[c])Object.prototype.hasOwnProperty.call(a[c],d)&&a[c][d].forEach(function(a){return b.push(a)});return b};g.prototype.getAllTags=function(){"use strict";var a=this.getTagsFromList(this._tagList),b=this.getTagsFromList(this._textTagList);return a.concat(b)};g.prototype.removeTag=function(a,c){"use strict";__p&&__p();var d=this._tagList[a],e=this._originalTagList[a]||{};e[c]?(this._dirtyPhotosByUid[c]=this._dirtyPhotosByUid[c]||{},this._dirtyPhotosByUid[c][a]=!0):delete this._dirtyPhotosByUid[c][a];for(var f in d)if(f==c){e=this._tagList[a][f];delete this._tagList[a][f];b("isEmpty")(this._tagList[a])&&delete this._tagList[a];return e}};g.prototype.removeTextTag=function(a,c){"use strict";var d=this._textTagList[a];if(!b("isEmpty")(d[c])){d=this._textTagList[a][c];this._textTagList[a][c]=[];b("isEmpty")(this._textTagList[a])&&delete this._textTagList[a];return d}return[]};g.prototype.removeAllNewTagsOfUser=function(a){"use strict";var b=[];if(!this.userHasDirtyTags(a))return b;var c=this._dirtyPhotosByUid[a];for(var d in c)b=b.concat(this.removeTag(d,a));return b};g.prototype.removeAllTagsFromPhoto=function(a){"use strict";__p&&__p();var c=[];if(!b("isEmpty")(this._tagList[a]))for(var d in this._tagList[a]){if(!Object.prototype.hasOwnProperty.call(this._tagList[a],d))continue;c=c.concat(this.removeTag(a,d))}if(!b("isEmpty")(this._textTagList[a]))for(var e in this._textTagList[a]){if(!Object.prototype.hasOwnProperty.call(this._textTagList[a],e))continue;c=c.concat(this.removeTextTag(a,e))}return c};g.prototype.storeTag=function(a,b,c,d,e){"use strict";this.storeTagWithOptions(a,b,c,d,{can_remove:e})};g.prototype.storeTagWithOptions=function(a,b,c,d,e){"use strict";this._dirtyPhotosByUid[b]=this._dirtyPhotosByUid[b]||{};this._dirtyPhotosByUid[b][a]=!0;c={x:c,y:d};Object.assign(c,e);!b?this.addTag(this._textTagList,a,c.name,c):this.addTag(this._tagList,a,b,c)};g.prototype.loadTagInfo=function(a,b){"use strict";this._tagList[a]={};this._originalTagList[a]={};for(var c=0;c<b.length;c++){var d=b[c];this.addTag(this._tagList,a,d.subject,d);this.addTag(this._originalTagList,a,d.subject,d)}};g.getInstance=function(){"use strict";g.instance===null&&new g();return g.instance};g.instance=null;e.exports=g}),null);
__d("TypeaheadHintText",["emptyFunction"],(function(a,b,c,d,e,f){function a(a){"use strict";this._typeahead=a}a.prototype.enable=function(){"use strict";this._typeahead.getCore().resetOnKeyup=!1};Object.assign(a.prototype,{disable:b("emptyFunction")});e.exports=a}),null);
__d("legacy:HintTextTypeaheadBehavior",["TypeaheadHintText"],(function(a,b,c,d,e,f){a.TypeaheadBehaviors||(a.TypeaheadBehaviors={}),a.TypeaheadBehaviors.hintText=function(a){a.enableBehavior(b("TypeaheadHintText"))}}),3);